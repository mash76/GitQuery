<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>GitQuery</title>
    <link href="./style.css" rel="stylesheet" type="text/css" />
  </head>
  <body>

    <!-- header -->
    <div class="underline" style="padding:3px;">
      <table width="100%" style="padding:0px;margin:0px;">
        <tr>
          <td width="50%" valign="top" >
            <span id="version" class="gray" >**version**</span>
            <span onClick="toggleDevTools()" class="btn" >devTools</span>
            <span onClick="$('#nodejs_info').slideToggle(10)" class="btn" >node-<span id="node_version"></span></span>
            <span onClick="toggleFullScreen()" class="btn" >fullScreen</span>

          </td>
          <td width="50%" align="right" >
            <span id="g_user" class="gray" ></span>
            <span onClick="$('#gitconf').toggle();" class="btn"> ~/.gitconfig ~/.gitignore_global</span>
          </td>
        </tr>
      </table>

      <div id="nodejs_info" class="detail hide"></div>
      <div id="gitconf" class="hide code detail" style="text-align:left;"></div>

      <div class="m5">
          <span onClick="toggleRepoList('local_repo_pane','toggle')" class="btn bold s120" >Repositories</span>
          <span onClick="showGitInit();" class="btn" >init</span>
          <span onClick="showGitClone();" class="btn" >clone</span>
          <span id="his_repo"></span>
      </div>
    </div>

    <!-- pane top -->

    <div id="gitinit_pane" pane="top" class="detail hide">
        init<br/>
        <div id="init_recommend_path" ></div>
        <input id="init_path" type="text" size="40" placeholder="init_path" />
        <input id="init_name" type="text" placeholder="project_name" />
        <button onClick="gitInit()" />init</button>
        <div id="init_result" type="text"  /></div>
    </div>

    <div id="gitclone_pane" pane="top" class="detail hide">
        git crone from remote<br/>
        <div id="clone_recommend_path" ></div>
        <input id="clone_dir"  type="text" size=50 placeholder="clone_dir" /><br/>
        <input id="clone_url"  type="text" size=80 placeholder="clone_url" />
        <div id="clone_result" type="text" /></div>
        <br/>
                <button onClick="osRunOut('git -C ' + $('#clone_dir').val() + ' clone ' + $('#clone_url').val() ,'clone_result')" />clone</button>
        <br/>
    </div>

    <div id="local_repo_pane" pane="top" class="detail hide" >
      <input type="text" id="filter_l_repo" size=20 />
      <div id="local_repo_list"></div>
    </div>

    <!-- current repository  -->

    <div id="repo_info" class="m10 hide">
        <span id="current_repo_name" class="bold s170">**current_repo**</span>
        <span id="current_repo_size" onClick="osRunOut('du -d1 -h ','pane_reposize'); togglePaneCurrentRepoDesc('pane_reposize','toggle')" class="bold s150 btn">**current_repo_size**</span>

        <span id="current_repo_path" class="gray">**current_repo_path**</span>
        <span onClick="osrun('open ' + path2dir(current_repo_path) )"  class="btn s80">finder</span>

        <span onClick="osRunOut('git fetch','pane_remote'); openPaneCenter('pane_remote')" class="btn s120">fetch</span>
        <span onClick="osRunOut('git pull','pane_remote'); openPaneCenter('pane_remote')" class="btn s120">pull</span>
        <span onClick="osRunOut('git push','pane_remote'); openPaneCenter('pane_remote')" class="btn s120">push</span>

        <br/>

        <span onClick="showBranchList()" >
          <span class="btn">branch</span><span id="local_branch_ct" class="btn s120 bold">**local_branch_ct**</span>
        </span>

        <span onClick="showIgnore()" class="btn">ignore</span>
        <span onClick="osRunOut('ls ' + current_repo_path + '/hooks','pane_hooks'); togglePaneCurrentRepoDesc('pane_hooks','toggle')" class="btn">hooks</span>

        <span onClick="showGitmodules()" class="btn">submodule</span><span id="submodule_count" class="btn s120 bold">**submodule_count**</span>

        <span onClick="showStashList(); togglePaneCurrentRepoDesc('pane_stash','toggle')" class="btn">stash</span><span id="stash_count" class="btn s120 bold"></span>
        <span onClick="osRunOut('cat ' + current_repo_path + '/config','pane_config'); togglePaneCurrentRepoDesc('pane_config','toggle')" class="btn">config</span>

        Remote
        <span onClick="osRunOut('git remote -v','pane_remote'); togglePaneCurrentRepoDesc('pane_remote','toggle')" class="btn">repo</span>

        <span onClick="osRunOut('git branch -r','pane_re_branch'); togglePaneCurrentRepoDesc('pane_re_branch','toggle')" >
          <span class="btn">branch</span><span id="remote_branch_ct" class="btn s120 bold">**remote_branch_ct**</span>
        </span>
        <br/>

        <!-- pane repo -->

        <div id="local_branch" pane="repo" class="code hide detail" >
            new branch <span class="silver s80">git branch branchname01   </span><br/>
            <input id="branch_name" type="text" placeholder="branch_name" />
            <button onClick="osRunOut('git branch \'' + $('#branch_name').val() + '\'','local_branch_details'); showBranchList();" placeholder="git command" />add</button>
            <div id="local_branch_details" ></div>
        </div>
        <div id="pane_stash" pane="repo" class="code hide detail" >
        </div>
        <div id="pane_hooks" pane="repo" class="code hide detail" >
        </div>
        <div id="pane_submodule" pane="repo" class="code hide detail" >
          new submodule <span class="silver s80">git submodule url://.../.git name01 </span><br/>
          <input id="submodule_url" type="text" placeholder="submodule_url" size="80"  />
          <input id="submodule_name" type="text" placeholder="submodule_name" />
          <button onClick="osRunOut('git submodule add \'' + $('#submodule_url').val() + '\' \'' + $('#submodule_name').val() + '\'','submodule_details'); " placeholder="git command" />add</button>
          <div id="submodule_details" ></div>

        </div>
        <div id="pane_config" pane="repo" class="code hide detail" >
        </div>
        <div id="pane_ignore" pane="repo" class="code hide detail" >
        </div>
        <div id="pane_remote" pane="repo" class="code hide detail" >
        </div>
        <div id="pane_re_branch" pane="repo" class="code hide detail" >
        </div>
        <div id="pane_reposize" pane="repo" class="detail code">
        </div>




        <!-- current branch -->

        <span id="c_branch" class="s170 bold">**c_branch**</span>
        <span id="latest_commit" class="s80 gray">97f809b  4 minutes ago </span>

          <a href="javascript:void(0)" onClick="makePaneFilelist(''); openPaneCenter('pane_filelist');" >
            files<span id="br_files_ct" class="bold s150">**br_files_ct**</span>
          </a>
          <a href="javascript:void(0)" onClick="makePaneLog('') " >
            commit<span id="br_commit_ct" class="bold s150">**br_commit_ct**</span>
          </a>



           <a href="javascript:void(0)" onClick="makePaneUser(''); openPaneCenter('pane_user');" >
             comitter<span id="br_member_ct" class="bold s150">**br_member_ct**</span>
           </a>

        <span onClick="makePaneStatus()"  class="btn">status</span>
        <span onClick="openPaneCenter('pane_gitcommand'); $('#git_usercommand').focus() "  class="btn ">git_command</span>

        <!-- pane center -->

        <div id="pane_gitcommand" pane="center" class="detail code">
            <input id="git_usercommand" type="text" size="70" placeholder="git command" />
            <button onClick="osRunOut($('#git_usercommand').val(),'pane_gitcommand_detail')" placeholder="git command" />run</button>
            <br/>
            <div id="pane_gitcommand_detail"></div>
        </div>



        <div id="pane_status" pane="center" class="detail code">
          <span onClick="makePaneStatus(); openPaneCenter('pane_status'); " class="btn s150">status</span>
          <span onClick="osRunOut('git add .','pane_status_detail'); openPaneCenter('pane_status'); "  class="btn s150">add</span>
          <span onClick="osRunOut('git reset','pane_status_detail'); openPaneCenter('pane_status'); "  class="btn s150">reset</span>
          <span onClick="$('#pane_status_commit').slideToggle(10); "  class="btn s150">commit</span>
          <span onClick="$('#pane_status_stash').slideToggle(10); "  class="btn s150">stash</span>

                    <div id="pane_status_commit" class="hide">

                        commit<br/>
                        <input id="commit_msg" type="text" placeholder="commit_msg name" />
                        <button onClick="osRunOut('git commit -m \'' + $('#commit_msg').val() + '\'','pane_status')" placeholder="commit message" />commit</button>
                        <br/>
                    </div>
                    <div id="pane_status_stash" class="hide">
                        stash <span class="silver s80">git stash comment01 </span><br/>
                        <input id="stash_comment" type="text" placeholder="remote_name" />
                        <button onClick="osRunOut('git stash name \'' + $('#stash_comment').val() + '\'','pane_status') " placeholder="stash message" />stash</button>

                    </div>

          <div id="pane_status_detail"></div>
        </div>

        <div id="pane_file" pane="center" class="detail code">
            <input type="text" id="filter_file" value="" size=20 >
            <div id="pane_file_filename" >  </div>
            <div id="pane_file_desc" >  </div>
            <div id="pane_file_detail_1" >  </div>
            <div id="pane_file_detail_2" >  </div>
        </div>

        <div id="pane_filelist" pane="center" class="detail code">
                <table ><tr><td valign=top >
                    Dir<br/>
                    <span id="pane_filelist_detail" >   </span>
                </td><td valign=top >
                      File<br/>
                      <span id="pane_filelist_ext" >   </span><br/>
                      <input type="text" id="filter_filelist" value="" size=20 >

                      <span class="s80 gray">RecentCommit</span>

                      <span onClick="makePaneFilelist( $('#filter_filelist').val() , 'git diff HEAD~5 HEAD --name-only ')" class="btn ">〜5c</span>
                      <span onClick="makePaneFilelist( $('#filter_filelist').val() , 'git diff HEAD~10 HEAD --name-only ')" class="btn ">10c</span>
                      <span onClick="makePaneFilelist( $('#filter_filelist').val() , 'git diff HEAD~30 HEAD --name-only ')" class="btn ">30c</span>
                      <span onClick="makePaneFilelist( $('#filter_filelist').val() , 'git diff HEAD~100 HEAD --name-only ')" class="btn ">100c</span>
                      <br/>

                      <span id="pane_filelist_detail_r" >  </span>
                </td></tr></table>
        </div>

        <div id="pane_diff" pane="center" class="detail code">
          <input type="text" id="filter_diff" value="" size=20 >
          <div id="pane_diff_detail"></div>
        </div>

        <div id="pane_log" pane="center" class="detail code">
            <span onClick="makePaneLog($('#filter_log').html())" class="btn s150">log</span>
            <span onClick="osRunOut('git log --graph --oneline ','pane_log_detail')" class="btn s150">tree</span>
            <br/>

            <input type="text" id="filter_log" value="" size=20 >
            <div id="pane_log_detail"></div>

        </div>

        <div id="pane_user" pane="center" class="detail code">
            <input type="text" id="filter_user" value="" size=20 >
            <div id="pane_user_detail"></div>
        </div>

        <div id="pane_commit" pane="center" class="detail code">

        </div>

        <div class="m10">
            current repo info
            <span onClick="findLocalRepos()" class="btn s80">files</span>
            <div id="c_repo_info" class="underline s80"> </div>

            <span onClick="$('div[name=file_detail]').toggle();" class="btn">toggle</span>
            btn
            <br/>
            <span id="c_repo_pane" >c_repo_pane</span>
        </div>

        <br/><br/>
        <div id="real_files"></div>
        <div id="os_out" style="font-size:60%;font-color:silver;"></div>

        new remote <span class="silver s80">git remote add branchname01 https://..../.git   </span><br/>
        <input id="remote_name" type="text" placeholder="remote_name" />
        <input id="remote_url" type="text" placeholder="remote_url" />
        <button onClick="osRunOut('git remote add  \'' + $('#remote_name').val() + '\' \'' + $('#remote_url').val() +'\'')" placeholder="git command" />add</button>
        <br/>
    </div>
  </body>

  <script>

    require('./renderer.js')
    require('./functions.js')

      window.jQuery = window.$ = require('./jquery-3.1.0.js')

      const log =console.log
      const BrowserWindow = require('electron').remote.BrowserWindow // windowオブジェクト
      const path = require('path')

      local_repos =[]
      local_files =[]
      his_repo =[] // リポジトリ選択履歴
      current_repo_path = ""
      interval_log_filter = null // 入力完了からログ検索までの秒数

      save_path = process.cwd() + '/userdata'
      execOption = { encoding: 'utf8',
                        timeout: 0,
                        maxBuffer: 2000*1024,  //200*1024
                        killSignal: 'SIGTERM',
                        cwd: '',
                        env: null }


      repo_btn_prev_push = "" //リポジトリ以下のBUTTONで直前push したもの
      repo_prev_push = ""

      top_filtered_repo = ""

    // You can also require other files to run in this process
     require('./repository.js')
     require('./center.js')
     require('./init.js')

    </script>
</html>
